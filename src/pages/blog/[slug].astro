---
import Layout from "../../layouts/Layout.astro";
import BlogPost from "../../components/pages/BlogPost";
import FAQSection from "../../components/FAQSection";
import { BLOG_POSTS } from "../../data/blogPosts";

export const prerender = true;

export function getStaticPaths() {
  return BLOG_POSTS.map((post) => ({
    params: { slug: post.slug },
  }));
}

const { slug } = Astro.params;
const post = BLOG_POSTS.find((p) => p.slug === slug);

if (!post) {
  return Astro.redirect("/404");
}
---

<Layout
  title={`${post.title} | Clear Retro Blog`}
  description={post.excerpt}
  image="/blog-placeholder.svg"
>
  {
    post.jsonLd && (
      <script
        type="application/ld+json"
        slot="head"
        set:html={JSON.stringify(post.jsonLd)}
      />
    )
  }

  <BlogPost post={post}>
    {post.faqs && <FAQSection client:visible faqs={post.faqs} />}
  </BlogPost>
</Layout>
